<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>No Vibes Just Code — 고급 설정</title>
  <link rel="stylesheet" href="options.css" />
</head>
<body>

  <div class="page">

    <header class="page-header">
      <h1 class="page-title">
        <span class="page-title-icon">🛡</span>
        No Vibes Just Code
        <span class="page-title-sub">고급 설정</span>
      </h1>
    </header>

    <main class="page-body">

      <!-- ── 섹션 1: 일반 설정 ── -->
      <section class="card">
        <h2 class="card-title">일반 설정</h2>

        <div class="field-group">
          <label class="field-label" for="apiUrlInput">Ollama API 주소</label>
          <input type="text" id="apiUrlInput" class="field-input"
            placeholder="http://localhost:11434" spellcheck="false" />
          <p class="field-hint">
            Ollama가 실행 중인 로컬 서버 주소. 기본값: <code>http://localhost:11434</code>
          </p>
        </div>

        <div class="field-group">
          <label class="field-label" for="modelInput">Ollama 모델</label>
          <input type="text" id="modelInput" class="field-input"
            placeholder="qwen2.5:3b" spellcheck="false" />
          <p class="field-hint">
            설치된 모델명. <code>ollama list</code>로 확인. 예: <code>qwen2.5:3b</code>, <code>gemma3</code>
          </p>
        </div>

        <div class="field-group">
          <label class="field-label" for="minLengthInput">최소 텍스트 길이 (자)</label>
          <div class="range-row">
            <input type="range" id="minLengthInput" class="range-input"
              min="30" max="500" step="10" />
            <span class="range-value" id="minLengthValue">100</span>
          </div>
          <p class="field-hint">이 길이 미만인 텍스트 블록은 AHI 분석을 건너뜁니다.</p>
        </div>

        <div class="field-group">
          <label class="field-label" for="excludedSitesInput">예외 사이트</label>
          <div class="tag-input-row">
            <input type="text" id="excludedSitesInput" class="field-input"
              placeholder="example.com" spellcheck="false" />
            <button class="btn-add" id="addSiteBtn" type="button">추가</button>
          </div>
          <div class="tag-list" id="excludedSitesList"></div>
          <p class="field-hint">도메인을 입력하면 해당 사이트에서는 분석이 비활성화됩니다.</p>
        </div>
      </section>

      <!-- ── 섹션 2: AHI 임계값 ── -->
      <section class="card">
        <h2 class="card-title">AHI 임계값</h2>

        <div class="field-group">
          <label class="field-label" for="blockThresholdInput">
            차단 임계값 — AHI ≥ 이 값이면 블라인드 처리
          </label>
          <div class="range-row">
            <input type="range" id="blockThresholdInput" class="range-input"
              min="30" max="90" step="5" />
            <span class="range-value" id="blockThresholdValue">40</span>
          </div>
          <div class="threshold-labels">
            <span>관대 (낮음)</span>
            <span>엄격 (높음)</span>
          </div>
        </div>

        <div class="field-group">
          <label class="field-label" for="preThresholdInput">
            Ollama 호출 임계값 — Phase 1 점수 ≥ 이 값이면 LLM 분석 실행
          </label>
          <div class="range-row">
            <input type="range" id="preThresholdInput" class="range-input"
              min="10" max="60" step="5" />
            <span class="range-value" id="preThresholdValue">30</span>
          </div>
          <p class="field-hint">
            기술 내용 없는 글(소셜미디어 등)은 이 값에 관계없이 Ollama가 호출됩니다.
            낮을수록 더 많이, 높을수록 명확한 호들갑 신호가 있는 글만 Ollama를 사용합니다.
          </p>
        </div>
      </section>

      <!-- ── 섹션 3: 가중치 설정 ── -->
      <section class="card">
        <h2 class="card-title">AHI 가중치 설정</h2>
        <p class="card-desc">
          4개 차원의 가중치 합계는 반드시 <strong>1.00</strong>이어야 합니다.
        </p>

        <div class="weight-sum-badge" id="weightSumBadge">합계: 1.00</div>

        <div class="field-group">
          <label class="field-label" for="w1Input">w1 — 언어적 인플레이션 (L)</label>
          <div class="range-row">
            <input type="range" id="w1Input" class="range-input weight-input"
              min="0" max="1" step="0.05" data-key="w1" />
            <span class="range-value" id="w1Value">0.15</span>
          </div>
        </div>

        <div class="field-group">
          <label class="field-label" for="w2Input">w2 — 공포/FOMO 유발 (F)</label>
          <div class="range-row">
            <input type="range" id="w2Input" class="range-input weight-input"
              min="0" max="1" step="0.05" data-key="w2" />
            <span class="range-value" id="w2Value">0.50</span>
          </div>
        </div>

        <div class="field-group">
          <label class="field-label" for="w3Input">w3 — 기술 구체성 결여 (1−T)</label>
          <div class="range-row">
            <input type="range" id="w3Input" class="range-input weight-input"
              min="0" max="1" step="0.05" data-key="w3" />
            <span class="range-value" id="w3Value">0.20</span>
          </div>
        </div>

        <div class="field-group">
          <label class="field-label" for="w4Input">w4 — 상업적 전환 의도 (C)</label>
          <div class="range-row">
            <input type="range" id="w4Input" class="range-input weight-input"
              min="0" max="1" step="0.05" data-key="w4" />
            <span class="range-value" id="w4Value">0.15</span>
          </div>
        </div>
      </section>

      <!-- ── 섹션 4: 데이터 관리 ── -->
      <section class="card">
        <h2 class="card-title">데이터 관리</h2>

        <div class="action-row">
          <button class="btn-secondary" id="exportBtn" type="button">설정 내보내기 (JSON)</button>
          <label class="btn-secondary btn-file-label" for="importFile">설정 가져오기</label>
          <input type="file" id="importFile" accept=".json" style="display:none" />
        </div>

        <div class="action-row" style="margin-top:8px">
          <button class="btn-danger" id="resetBtn" type="button">기본값으로 초기화</button>
        </div>
      </section>

    </main>

    <!-- Save indicator -->
    <div class="save-toast" id="saveToast">저장됨 ✓</div>

  </div>

  <script src="../shared/constants.js"></script>
  <script src="../shared/storage.js"></script>
  <script src="options.js"></script>
</body>
</html>
